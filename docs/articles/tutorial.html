<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cookie: representative samples selection from large population by using k-medoids clustering • Cookie</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cookie: representative samples selection from large population by using k-medoids clustering">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Cookie</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial.html">Cookie: representative samples selection from large population by using k-medoids clustering</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Cookie: representative samples selection from large population by using k-medoids clustering</h1>
                        <h4 class="author">Lei Li</h4>
            <address class="author_afil">
      University of Chicago, Chicago, IL 60637<br><a class="author_email" href="mailto:#"></a><a href="mailto:leil@uchicago.edu" class="email">leil@uchicago.edu</a>
      </address>
                  
            <h4 class="date">2019-09-13</h4>
      
      
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<div id="prerequisite" class="section level1">
<h1 class="hasAnchor">
<a href="#prerequisite" class="anchor"></a>Prerequisite</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(devtools)){</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(ggradar)){</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">install_github</a></span>(<span class="st">"ricardo-bion/ggradar"</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">}</a></code></pre></div>
</div>
<div id="load-package" class="section level1">
<h1 class="hasAnchor">
<a href="#load-package" class="anchor"></a>Load package</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Cookie)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cowplot)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a></code></pre></div>
</div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<p>User can use read.csv() to load data into R. Columns should be factors, and each sample should have an unique name or ID (in this example is cell barcode). The missing values should be indicated by “NA” in CSV file. Users can arrange and edit their data in Excel and then import into R.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"data.csv"</span>, <span class="dt">package =</span> <span class="st">"Cookie"</span>), <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="create-object" class="section level1">
<h1 class="hasAnchor">
<a href="#create-object" class="anchor"></a>Create object</h1>
<p>Create data object and determine factor types</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/createCookieObject.html">createCookieObject</a></span>(<span class="dt">data=</span>data,<span class="dt">factor.type =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"char"</span>,<span class="st">"char"</span>,<span class="st">"char"</span>,<span class="st">"char"</span>,<span class="st">"num"</span>))</a></code></pre></div>
</div>
<div id="normalize-data-for-numerical-factors" class="section level1">
<h1 class="hasAnchor">
<a href="#normalize-data-for-numerical-factors" class="anchor"></a>Normalize data (for numerical factors)</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normalization.html">normalization</a></span>(cookie)</a></code></pre></div>
</div>
<div id="calculate-pair-wise-distances" class="section level1">
<h1 class="hasAnchor">
<a href="#calculate-pair-wise-distances" class="anchor"></a>Calculate pair-wise distances</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/distCalculation.html">distCalculation</a></span>(cookie)</a></code></pre></div>
</div>
<div id="generate-non-linear-dim-reduction" class="section level1">
<h1 class="hasAnchor">
<a href="#generate-non-linear-dim-reduction" class="anchor"></a>Generate non-linear dim reduction</h1>
<p>Users also can use UMAP (<a href="https://github.com/tkonopka/umap" class="uri">https://github.com/tkonopka/umap</a>) to generate non-linear reduction. Two methods is available: “naive” and “umap-learn”. To use “umap-learn”, users may need to install python package “umap-learn” (<a href="https://pypi.org/project/umap-learn/" class="uri">https://pypi.org/project/umap-learn/</a>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/reductionTSNE.html">reductionTSNE</a></span>(cookie)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#cookie &lt;- reductionUMAP(cookie)</span></a></code></pre></div>
</div>
<div id="see-how-factors-distributed" class="section level1">
<h1 class="hasAnchor">
<a href="#see-how-factors-distributed" class="anchor"></a>See how factors distributed</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotReduction.html">plotReduction</a></span>(cookie, <span class="dt">reduction =</span> <span class="st">"tsne"</span>, <span class="dt">group.factor =</span> <span class="st">"Subject"</span>) </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotReduction.html">plotReduction</a></span>(cookie, <span class="dt">reduction =</span> <span class="st">"tsne"</span>, <span class="dt">group.factor =</span> <span class="st">"Isotype"</span>) </a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(p1,p2,<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Subject"</span>,<span class="st">"Isotype"</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
</div>
<div id="test-coverages-for-different-sample-size-to-determine-an-appropriate-sample-size" class="section level1">
<h1 class="hasAnchor">
<a href="#test-coverages-for-different-sample-size-to-determine-an-appropriate-sample-size" class="anchor"></a>Test coverages for different sample size to determine an appropriate sample size</h1>
<p>we run two test 1) with prime factor 2) without prime factor</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampleSizeTest.html">sampleSizeTest</a></span>(cookie, <span class="dt">prime.factor =</span> <span class="st">"Subject"</span>,<span class="dt">size.range =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">15</span>),<span class="dt">name =</span> <span class="st">"run1"</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co"># When selecting samples from entire large population, users can use fast.mode = 3, 4, or 5 to enable FastPAM algorithm.  </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampleSizeTest.html">sampleSizeTest</a></span>(cookie, <span class="dt">size.range =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>,<span class="dv">110</span>,<span class="dv">120</span>),<span class="dt">name =</span> <span class="st">"run2"</span>, <span class="dt">fast.mode =</span> <span class="dv">5</span>)</a></code></pre></div>
<div id="with-prime-factor-coverage-rate-of-each-sample-size" class="section level3">
<h3 class="hasAnchor">
<a href="#with-prime-factor-coverage-rate-of-each-sample-size" class="anchor"></a>1) with prime factor, coverage rate of each sample size</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSizeTest.html">plotSizeTest</a></span>(cookie, <span class="dt">test.name =</span> <span class="st">"run1"</span>, <span class="dt">chart.type =</span> <span class="st">"line"</span>, <span class="dt">coverage.type =</span> <span class="st">"pct"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSizeTest.html">plotSizeTest</a></span>(cookie, <span class="dt">test.name =</span> <span class="st">"run1"</span>, <span class="dt">chart.type =</span> <span class="st">"radar"</span>, <span class="dt">coverage.type =</span> <span class="st">"pct"</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(p1,p2,<span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">rel_widths =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="fl">1.5</span>))</a></code></pre></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-10-1.png" width="768"> ### 2) without prime factor, coverage rate of each sample size</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSizeTest.html">plotSizeTest</a></span>(cookie, <span class="dt">test.name =</span> <span class="st">"run2"</span>, <span class="dt">chart.type =</span> <span class="st">"line"</span>, <span class="dt">coverage.type =</span> <span class="st">"pct"</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSizeTest.html">plotSizeTest</a></span>(cookie, <span class="dt">test.name =</span> <span class="st">"run2"</span>, <span class="dt">chart.type =</span> <span class="st">"radar"</span>, <span class="dt">coverage.type =</span> <span class="st">"pct"</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(p1,p2,<span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">rel_widths =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="fl">1.5</span>))</a></code></pre></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-11-1.png" width="768"> # After determine an appropriate sample size, users can select samples from original population we run two sampling 1) with prime factor 2) without prime factor</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampling.html">sampling</a></span>(cookie, <span class="dt">prime.factor =</span> <span class="st">"Subject"</span>,<span class="dt">important.factor =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Isotype"</span>),<span class="dt">sample.size =</span> <span class="dv">5</span>,<span class="dt">name =</span> <span class="st">"run1"</span>)</a></code></pre></div>
<pre><code>## Warning in cor(population$FreqSel, population$Freq): the standard deviation
## is zero</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># When selecting samples from entire large population, users can use fast.mode = 3, 4, or 5 to enable FastPAM algorithm.(https://stat.ethz.ch/R-manual/R-patched/library/cluster/html/pam.html)</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">cookie &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampling.html">sampling</a></span>(cookie, <span class="dt">important.factor =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Isotype"</span>,<span class="st">"Subject"</span>),<span class="dt">sample.size =</span> <span class="dv">90</span>, <span class="dt">name =</span> <span class="st">"run2"</span>, <span class="dt">fast.mode =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Coverage on each factor of current sampling 1) with prime factor Because all samples were selected evenly from each subject, the STD of selected samples on subject is 0. The CC value is not available. We set CC to 0.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSampling.html">plotSampling</a></span>(cookie,<span class="dt">name =</span> <span class="st">"run1"</span>, <span class="dt">coverage.type =</span> <span class="st">"pct"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSampling.html">plotSampling</a></span>(cookie,<span class="dt">name =</span> <span class="st">"run1"</span>, <span class="dt">coverage.type =</span> <span class="st">"cc"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(p1,p2,<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Coverage rates"</span>,<span class="st">"CC values between original and selection"</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
</div>
<div id="coverage-on-each-factor-of-current-sampling-2-without-prime-factor" class="section level3">
<h3 class="hasAnchor">
<a href="#coverage-on-each-factor-of-current-sampling-2-without-prime-factor" class="anchor"></a>Coverage on each factor of current sampling 2) without prime factor</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSampling.html">plotSampling</a></span>(cookie,<span class="dt">name =</span> <span class="st">"run2"</span>, <span class="dt">coverage.type =</span> <span class="st">"pct"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotSampling.html">plotSampling</a></span>(cookie,<span class="dt">name =</span> <span class="st">"run2"</span>, <span class="dt">coverage.type =</span> <span class="st">"cc"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(p1,p2,<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Coverage rates"</span>,<span class="st">"CC values between original and selection"</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
</div>
<div id="selected-samples-loacted-on-2d-map" class="section level3">
<h3 class="hasAnchor">
<a href="#selected-samples-loacted-on-2d-map" class="anchor"></a>Selected samples loacted on 2D map</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotReduction.html">plotReduction</a></span>(cookie, <span class="dt">reduction =</span> <span class="st">"tsne"</span>, <span class="dt">group.factor =</span> <span class="st">"Subject"</span>, <span class="dt">sampling =</span> <span class="st">"run1"</span>) </a>
<a class="sourceLine" id="cb17-2" data-line-number="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotReduction.html">plotReduction</a></span>(cookie, <span class="dt">reduction =</span> <span class="st">"tsne"</span>, <span class="dt">group.factor =</span> <span class="st">"Isotype"</span>, <span class="dt">sampling =</span> <span class="st">"run1"</span>) </a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(p1,p2,<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Subject"</span>,<span class="st">"Isotype"</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<p>Distribution of original population and current sampling</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"original"</span>,<span class="dt">factor =</span> <span class="st">"Subject"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"original"</span>,<span class="dt">factor =</span> <span class="st">"Seuret_Cluster"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">p3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"original"</span>,<span class="dt">factor =</span> <span class="st">"Isotype"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">p4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"original"</span>,<span class="dt">factor =</span> <span class="st">"V.locus"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">p5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"original"</span>,<span class="dt">factor =</span> <span class="st">"CDR3.length"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"></a>
<a class="sourceLine" id="cb18-7" data-line-number="7">p6 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"run2"</span>,<span class="dt">factor =</span> <span class="st">"Subject"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">p7 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"run2"</span>,<span class="dt">factor =</span> <span class="st">"Seuret_Cluster"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">p8 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"run2"</span>,<span class="dt">factor =</span> <span class="st">"Isotype"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">p9 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"run2"</span>,<span class="dt">factor =</span> <span class="st">"V.locus"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">p10 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plotDistribution.html">plotDistribution</a></span>(cookie, <span class="dt">sampling =</span> <span class="st">"run2"</span>,<span class="dt">factor =</span> <span class="st">"CDR3.length"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb18-12" data-line-number="12"></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Original-Subject"</span>,<span class="st">"Original-Cluster"</span>,<span class="st">"Original-Isotype"</span>,<span class="st">"Original-V.locus"</span>,<span class="st">"Original-CDR3.length"</span>,<span class="st">"Sampling-Subject"</span>,<span class="st">"Sampling-Cluster"</span>,<span class="st">"Sampling-Isotype"</span>,<span class="st">"Sampling-V.locus"</span>,<span class="st">"Sampling-CDR3.length"</span>))</a></code></pre></div>
<p><img src="tutorial_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#prerequisite">Prerequisite</a></li>
      <li><a href="#load-package">Load package</a></li>
      <li><a href="#load-data">Load data</a></li>
      <li><a href="#create-object">Create object</a></li>
      <li><a href="#normalize-data-for-numerical-factors">Normalize data (for numerical factors)</a></li>
      <li><a href="#calculate-pair-wise-distances">Calculate pair-wise distances</a></li>
      <li><a href="#generate-non-linear-dim-reduction">Generate non-linear dim reduction</a></li>
      <li><a href="#see-how-factors-distributed">See how factors distributed</a></li>
      <li><a href="#test-coverages-for-different-sample-size-to-determine-an-appropriate-sample-size">Test coverages for different sample size to determine an appropriate sample size</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lei Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
